{% extends "./base.html" %}

{% block content %}
    <div class="separator"><i class="material-icons" style="color:black">person_pin</i>&nbsp;<h2 class="content-separator">Pinned Posts</h2></div>
    <div class="row pinned-posts">
        {% for post in latest_post_list %}
            {% if post.is_pinned %}
                {% if "Post" in post.kind %}
                    <!-- Blog post card -->
                    <div class="col s12 m6 l3">
                        <div class="card blue-grey darken-1 post">
                            <div class="card-content with-comments white-text post">
                                <div>
                                    <span class="card-title">{{ post.title }}</span>
                                    <div class="card-description post-preview">
                                        <p>{{ post.detail|striptags|safe|truncatechars:90 }}</p>
                                    </div>
                                </div>
                                <div class="card-comments">{{ post.comment_count_string }}</div>
                            </div>
                            <div class="card-action voting">
                                <div class="score-container">
                                    <a class="btn-flat vote" style="padding-left: 0"><i id="downvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_downward</i></a>
                                    <span id="score-{{ post.id }}" class="score">{{ post.score }}</span>
                                    <a class="btn-flat vote"><i id="upvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_upward</i></a>
                                </div>
                                <a class="card-open" href="/blogs/{{ post.id }}">Open</a>
                            </div>
                        </div>
                    </div>
                {% elif "Question" in post.kind %}
                    <!-- Question card -->
                    <div class="col s12 m6 l3">
                        <div class="card blue-grey darken-1 question">
                            <div class="card-content with-comments white-text">
                                <span class="card-title" style="display:flex;"><i class="material-icons title">question_answer</i>{{ post.title }}</span>
                                <div class="card-description question">
                                    <p>{{ post.detail }}</p>
                                </div>
                                <div class="card-comments">{{ post.comment_count_string }}</div>
                            </div>
                            <div class="card-action voting">
                                <div class="score-container">
                                    <a class="btn-flat vote" style="padding-left: 0"><i id="downvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_downward</i></a>
                                    <span id="score-{{ post.id }}" class="score">{{ post.score }}</span>
                                    <a class="btn-flat vote"><i id="upvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_upward</i></a>
                                </div>
                                <a class="card-open" href="/blogs/{{ post.id }}">Open</a>
                            </div>
                        </div>
                    </div>
                {% elif "Image" in post.kind %}

                    <!-- Blog post card -->
                    <div class="col s12 m6 l3">
                        <div class="card blue-grey darken-1">
                            <!-- <div class="card-content white-text">
                                <span class="card-title">{{ post.title }}</span>
                            </div> -->
                            <div class="card-image post">
                                <img src="{{ post.detail }}" style="min-height: 205px">
                                <div class="card-title image-post">{{ post.title }}</div>
                            </div>
                            <div class="card-action voting">
                                <div class="score-container">
                                    <a class="btn-flat vote" style="padding-left: 0"><i id="downvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_downward</i></a>
                                    <span id="score-{{ post.id }}" class="score">21</span>
                                    <a class="btn-flat vote"><i id="upvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_upward</i></a>
                                </div>
                                <a class="card-open" href="/blogs/{{ post.id }}">Open</a>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        {% endfor %}

    </div>

    <div class="separator" style="margin-top:0;">
        <!-- <hr style="width: 300px;margin:0;"> -->
        <i class="material-icons" style="color:black">stars</i>
        &nbsp;
        <h2 class="content-separator">Top Posts</h2>
    </div>
    <div class="row" style="padding-bottom: 30px;">

        {% for post in latest_post_list %}
            {% if not post.is_pinned %}
                {% if "Post" in post.kind %}
                    <!-- Blog post card -->
                    <div class="col s12 m6 l3">
                        <div class="card blue-grey darken-1 post">
                            <div class="card-content with-comments white-text post">
                                <div style="display:grid; grid-template: 1fr / 42px 1fr;">
                                    <div style="display: flex;flex-direction: column;align-items: center;">
                                        <i class="material-icons title tooltipped" data-position="top" data-tooltip="Article Post">event_note</i>
                                        <i class="material-icons title fa-clickable fas fa-thumbtack tooltipped" data-position="top" data-tooltip="Click to Pin"></i>
                                        <i class="material-icons title fa-clickable far fa-heart tooltipped" data-position="top" data-tooltip="Click to Save"></i>
                                    </div>
                                    <div style="display:flex;flex-direction: column;">
                                        <span class="card-title">{{ post.title }}</span>
                                        <div class="card-description post-preview">
                                            <p>{{ post.detail|striptags|safe|truncatechars:90 }}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-comments">{{ post.comment_count_string }}</div>
                            </div>
                            <div class="card-action voting">
                                <div class="score-container">
                                    <a class="btn-flat vote" style="padding-left: 0"><i id="downvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_downward</i></a>
                                    <span id="score-{{ post.id }}" class="score">{{ post.score }}</span>
                                    <a class="btn-flat vote"><i id="upvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_upward</i></a>
                                </div>
                                <a class="card-open" href="/blogs/{{ post.id }}">Open</a>
                            </div>
                        </div>
                    </div>
                    
                {% elif "Question" in post.kind %}
                    <!-- Question card -->
                    <div class="col s12 m6 l3">
                        <div class="card blue-grey darken-1 question">
                            <div class="card-content with-comments white-text" style="min-height: 201px;display: flex;flex-direction: column;justify-content: space-between;">
                                <span class="card-title" style="display:flex;"><i class="material-icons title">question_answer</i>{{ post.title }}</span>
                                <div class="card-comments">{{ post.comment_count_string }}</div>
                            </div>
                            <div class="card-action voting">
                                <div class="score-container">
                                    <a class="btn-flat vote" style="padding-left: 0"><i id="downvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_downward</i></a>
                                    <span id="score-{{ post.id }}" class="score">{{ post.score }}</span>
                                    <a class="btn-flat vote"><i id="upvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_upward</i></a>
                                </div>
                                <a class="card-open" href="/blogs/{{ post.id }}">Open</a>
                            </div>
                        </div>
                    </div>
                {% elif "Image" in post.kind %}

                    <!-- Blog post card -->
                    <div class="col s12 m6 l3">
                        <div class="card blue-grey darken-1">
                            <!-- <div class="card-content white-text">
                                <span class="card-title">{{ post.title }}</span>
                            </div> -->
                            <div class="card-image post">
                                <img src="{{ post.detail }}" style="min-height: 205px">
                                <div class="card-title image-post">{{ post.title }}</div>
                            </div>
                            <div class="card-action voting">
                                <div class="score-container">
                                    <a class="btn-flat vote" style="padding-left: 0"><i id="downvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_downward</i></a>
                                    <span id="score-{{ post.id }}" class="score">{{ post.score }}</span>
                                    <a class="btn-flat vote"><i id="upvote-{{ post.id }}" post_id="{{ post.id }}" class="material-icons">arrow_upward</i></a>
                                </div>
                                <a class="card-open" href="/blogs/{{ post.id }}">Open</a>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
        {% endfor %}

    </div>

    <script>
        //initialise tooltips
        $(document).ready(() => {
            $('.tooltipped').tooltip();
        });
    </script>
<!--<script>-->
    <!--$(function(){-->
        <!--$("#Email").bind('input porpertychange',function(){-->
            <!--var regEmail = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/-->
            <!--if (regEmail.test($(this).val()) == false){-->
                <!--$('.email-error').css("display","block");-->
            <!--}-->
            <!--if (regEmail.test($(this).val())){-->
                <!--$('.email-error').css("display","none");-->
            <!--}-->
        <!--});-->


        <!--$("#repassword").bind('input porpertychange',function(){-->
            <!--if($('#repassword').val() != $('#password').val() ){-->
                <!--$('.password-error').css("display","block");-->
            <!--}-->

            <!--if($('#repassword').val() == $('#password').val() ){-->
                <!--$('.password-error').css("display","none");-->
            <!--}-->
        <!--});-->
    <!--});-->
<!--</script>-->
{% endblock %}